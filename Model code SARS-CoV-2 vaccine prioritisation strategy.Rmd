---
title: '**The effect of outcome choice on vaccine allocation: a modelling study**'
author: "Eleanor Burch (a), Ellen Brooks-Pollock (a), Hannah Christensen (a).     (a) Population Health Sciences, Bristol Medical School, University of Bristol, Bristol, United Kingdom."
date: "22/04/2025"
output:
 html_document: default
 pdf_document: default
 word_document: default
---

```{r setup, include = FALSE}

knitr::opts_chunk$set(echo = TRUE, warning = FALSE, comment = NA, out.width = '1500px', dpi = 300)

```

In this study we reproduced and extended a mathematical model of single-dose and two-dose SARS-CoV-2 vaccine dose allocation strategies developed by Hill and Keeling. (1)  We introduced life-years saved as an alternative outcome to deaths averted. We also included up-to-date estimates for the risk of mortality due to COVID-19 and vaccine uptake levels for different groups of the population of England.

```{r}

library(ggplot2)
library(patchwork)
library(gtable)
library(grid)
library(gridExtra)
library(cowplot)
library(RColorBrewer)
library(tidytable)
library(openxlsx)
library(ggtext)
library(dplyr)

theme_set(theme_light(base_size = 15))
options(scipen=999)

```

#### **Priority groups**

The JCVI priority groups for vaccination are as follows (2):
1. Care home residents and staff  
2. ≥80 years & Health Care Workers (HCW)  
3. 75–79 years  
4. 70–74 years & Clinically Extremely Vulnerable (CEV)  
5. 65–69 years  
6. Underlying Health Conditions (UHC)  
7. 60–64 years  
8. 55–59 years  
9. 50–54 years  
10. 0–49 years  

We have separated groups 1 and 2 into their respective subgroups in order to set different mortality rates and life-years remaining for the subgroups. The subgroups are still vaccinated at an equal rate so that the priority group vaccination order is unchanged.

The estimates for the sizes of each priority group in the population (in millions) are (3):

```{r}

# When priority groups 1 and 2 consist of the combined population subgroups:

population_size_condensed <- c(0.7, 6.0, 1.9, 3.7, 2.4, 6.2, 1.5, 2.0, 2.3, 29.3)    

# Splitting priority groups 1 and 2 into their respective subgroups

population_size <- c(0.3, 0.4, 2.8, 3.2, 1.9, 3.7, 2.4, 6.2, 1.5, 2.0, 2.3, 29.3)

# The total population is:

total_pop <- sum(population_size)

```

#### **Plotting deaths averted against number of available doses**  

The proportion of each group receiving one dose of vaccine, with the initial values set to zero, is:

```{r}  

# When priority groups 1 and 2 consist of the combined population subgroups:

prop_vaccinated_1_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)       

# Splitting priority groups 1 and 2 into their respective subgroups

prop_vaccinated_1 <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)         

```            

The proportion of each group receiving two doses of vaccine, with the initial values set to zero, is:

```{r}  

# When priority groups 1 and 2 consist of the combined population subgroups:

prop_vaccinated_2_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)  

# Splitting priority groups 1 and 2 into their respective subgroups

prop_vaccinated_2 <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)  

```            

The number of doses that have been allocated is initially set to zero.

```{r}

doses_allocated <- 0   

```

The values for vaccine effectiveness were based on estimates from Public Health England of efficacy of both the Pfizer and AstraZeneca vaccines against COVID-19 mortality, in relation to the Alpha variant. (4) Here, we took the upper and lower estimates of the vaccine efficacy (70 – 85% for one dose and 75 – 99% for two doses) and a range of values in this interval were considered.

The vaccine effectiveness of the first dose is varied from 70% to 85% in increments of 5%:

```{r}

VE1 <- seq(0.7, 0.85, 0.05)

```

The vaccine effectiveness of the second dose is varied from 75% to 99% in increments of 8%:

```{r}

VE2 <- seq(0.75, 0.99, 0.08)  

```

The number of available vaccine doses is initially varied from 0 to 4 million in steps of 1 million:

```{r}

doses_available <- seq(0, 4, 1)

```

COVID-19 vaccine uptake levels for the age-groups, care home residents and staff, healthcare workers, and people who are clinically extremely vulnerable were obtained from the National Health Service (NHS) England website, using the ‘weekly announced vaccinations’ data from 3rd March 2022. (5) Vaccine uptake levels for people with underlying health conditions were assumed to be an average of the uptake levels for those aged 60-64 years and those aged 65-69 years.

Uptake levels of the first dose for each priority group are as follows:

```{r}

# When priority groups 1 and 2 consist of the combined population subgroups:

uptake_1_condensed <- c(0.96, 0.93, 1.0, 0.96, 0.97, 0.98, 0.99, 0.98, 0.95, 0.84)     

# Splitting priority groups 1 and 2 into their respective subgroups

uptake_1 <- c(0.96, 0.96, 0.92, 0.94, 1.0, 0.96, 0.97, 0.98, 0.99, 0.98, 0.95, 0.84)

```

Uptake levels of the second dose for each priority group are as follows:

```{r}

# When priority groups 1 and 2 consist of the combined population subgroups:

uptake_2_condensed <- c(0.95, 0.91, 1.0, 0.95, 0.96, 0.97, 0.98, 0.96, 0.93, 0.75)  

# Splitting priority groups 1 and 2 into their respective subgroups

uptake_2 <- c(0.95, 0.95, 0.91, 0.91, 1.0, 0.95, 0.96, 0.97, 0.98, 0.96, 0.93, 0.75)

```

We used Office for National Statistics (ONS) data showing the number of deaths registered where COVID-19 was mentioned on the death certificate in 2020 to project the average annual number of deaths for each age group in England in the absence of vaccination. (6) The mortality risk was calculated by dividing the number of deaths in each age group by the population size of the group. The mortality risk for care home residents was estimated using the 2020 ONS data showing deaths of care home residents notified to the Care Quality Commission (CQC), during the period 10 April – 18 December 2020. (7) The COVID-19 mortality rate in care home staff and health care workers between 9 March and 28 December 2020 was obtained from ONS data showing deaths by occupation. (8) Risk of mortality for clinically extremely vulnerable individuals was assumed to be the same as for the 70-74 age group, and the mortality risk for those with underlying health conditions was assumed to be an average of the risk for the 60-64 and 65-69 age groups.

Estimates for the risk of mortality due to COVID-19 for each priority group are as follows:

```{r}  

mortality_risk <- c(0.1218, 0.0009420, 0.01960, 0.0003732, 0.006533, 0.002312, 0.002135, 0.002283, 0.002431, 
                    0.001236, 0.0006291, 0.00005865)

```

Using these vaccine uptake levels and risk of mortality, the number of deaths averted are plotted against the total number of available doses, following the one-dose only and two-dose only allocation strategies (*Figure 2*).

```{r, echo = FALSE}

# 4 million available doses

# One-dose vaccine allocation strategy

doses_available <- seq(0, 4, 1) 
deaths_averted_4_mill_doses <- matrix(NA, nrow = length(doses_available), ncol = length(VE1) * 2)
cols <- brewer.pal(n = 4, name = "RdBu")
allocation_matrix_condensed <- matrix(0, nrow = 26, ncol = 10)
allocation_matrix <- matrix(0, nrow = 26, ncol = 12)

# The following loop allocates the doses in order from the highest priority group down to the lowest priority group, given a fixed number of available doses (in millions), and according to the vaccine uptake levels above. The doses are allocated following the one-dose strategy

# Equation 1 calculates the annual number of deaths averted following the one-dose allocation strategy 


for(k in 1:length(VE1)){
  for(j in 1:length(doses_available)){ 
    prop_vaccinated_1_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
    doses_allocated <- 0
    for (i in 1:length(prop_vaccinated_1_condensed)){
      if (doses_available[j] > (doses_allocated + uptake_1_condensed[i] * population_size_condensed[i])){
        prop_vaccinated_1_condensed[i] <- uptake_1_condensed[i]
        doses_allocated <- doses_allocated + uptake_1_condensed[i] * population_size_condensed[i]
      }
      else if ((doses_available[j] < (doses_allocated + uptake_1_condensed[i] * population_size_condensed[i])) && 
               (doses_available[j] > doses_allocated)){
        prop_vaccinated_1_condensed[i] <- (doses_available[j] - doses_allocated) / population_size_condensed[i]
        doses_allocated <- doses_allocated + prop_vaccinated_1_condensed[i] * population_size_condensed[i]
      }
      else {
        prop_vaccinated_1_condensed[i] <- 0
      }
    }
    prop_vaccinated_1[1] <- min(prop_vaccinated_1_condensed[1], uptake_1[1])
    prop_vaccinated_1[2] <- min(prop_vaccinated_1_condensed[1], uptake_1[2])
    prop_vaccinated_1[3] <- min(prop_vaccinated_1_condensed[2], uptake_1[3])
    prop_vaccinated_1[4] <- min(prop_vaccinated_1_condensed[2], uptake_1[4])
    if (prop_vaccinated_1[4] == uptake_1_condensed[2]) {prop_vaccinated_1[4] <- uptake_1[4]}
    prop_vaccinated_1[5:12] <- prop_vaccinated_1_condensed[3:10]
    deaths_averted_4_mill_doses[j, k] = sum(prop_vaccinated_1 * VE1[k] * population_size * mortality_risk * 10^6)    #Equation 1
    allocation_matrix_condensed[j, ] <- prop_vaccinated_1_condensed
    allocation_matrix[j, ] <- prop_vaccinated_1
  }
}


# Two-dose vaccine allocation strategy

doses_allocated <- 0

# The following loop allocates the doses in order from the highest priority group down to the lowest priority group, given a fixed number of available doses (in millions), and according to the vaccine uptake levels above. The doses are allocated following the one-dose strategy

# Equation 2 calculates the annual number of deaths averted following the two-dose allocation strategy 

for(k in 1:length(VE2)){
  for(j in 1:length(doses_available)){
    prop_vaccinated_2_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
    doses_allocated <- 0
    for (i in 1:length(prop_vaccinated_2_condensed)){
      if ((doses_available[j] / 2) > (doses_allocated + uptake_2_condensed[i] * population_size_condensed[i])){
        prop_vaccinated_2_condensed[i] <- uptake_2_condensed[i]
        doses_allocated <- doses_allocated + uptake_2_condensed[i] * population_size_condensed[i]
      }
      else if (((doses_available[j] / 2) < (doses_allocated + uptake_2_condensed[i] * population_size_condensed[i])) && 
               ((doses_available[j] / 2) > doses_allocated)){
        prop_vaccinated_2_condensed[i] <- ((doses_available[j] / 2) - doses_allocated) / population_size_condensed[i]
        doses_allocated <- doses_allocated + prop_vaccinated_2_condensed[i] * population_size_condensed[i]
      }
      else {
        prop_vaccinated_2_condensed[i] <- 0
      }
    }
    prop_vaccinated_2[1] <- min(prop_vaccinated_2_condensed[1], uptake_2[1])
    prop_vaccinated_2[2] <- min(prop_vaccinated_2_condensed[1], uptake_2[2])
    prop_vaccinated_2[3] <- min(prop_vaccinated_2_condensed[2], uptake_2[3])
    prop_vaccinated_2[4] <- min(prop_vaccinated_2_condensed[2], uptake_2[4])
    prop_vaccinated_2[5:12] <- prop_vaccinated_2_condensed[3:10]
    deaths_averted_4_mill_doses[j, k + length(VE1)] = sum(prop_vaccinated_2 * VE2[k] * population_size * mortality_risk * 10^6)             #Equation 2
    allocation_matrix_condensed[j + length(doses_available), ] <- prop_vaccinated_2_condensed
    allocation_matrix[j + length(doses_available), ] <- prop_vaccinated_2
  }
}

# Plotting deaths averted with 4 million doses

rownames(deaths_averted_4_mill_doses) <- doses_available
colnames(deaths_averted_4_mill_doses) <- c("1-dose, VE1 = 0.7", "1-dose, VE1 = 0.75", "1-dose, VE1 = 0.80", "1-dose, VE1 = 0.85",
                                           "2-dose, VE2 = 0.75", "2-dose, VE2 = 0.83", "2-dose, VE2 = 0.91", "2-dose, VE2 = 0.99")
df_deaths_averted_4_mill_doses <- data.frame(deaths_averted_4_mill_doses) |>
  pivot_longer(everything(),
               names_to = "Strategy and VE",
               values_to = "Deaths averted")
df_deaths_averted_4_mill_doses$Strategy <- c(rep("1-dose", length(doses_available) * length(VE1)), rep("2-dose", length(doses_available) * length(VE2)))
df_deaths_averted_4_mill_doses$VE <- c(rep("VE1 = 0.7", length(doses_available)), rep("VE1 = 0.75", length(doses_available)),
                                       rep("VE1 = 0.8", length(doses_available)), rep("VE1 = 0.85", length(doses_available)),
                                       rep("VE2 = 0.75", length(doses_available)), rep("VE2 = 0.83", length(doses_available)),
                                       rep("VE2 = 0.91", length(doses_available)), rep("VE2 = 0.99", length(doses_available)))
df_deaths_averted_4_mill_doses$VE_f <- factor(df_deaths_averted_4_mill_doses$VE, levels = 
                                                c("VE1 = 0.7", "VE1 = 0.75", "VE1 = 0.8", "VE1 = 0.85", 
                                                  "VE2 = 0.75", "VE2 = 0.83", "VE2 = 0.91", "VE2 = 0.99"))
df_deaths_averted_4_mill_doses$Doses <- rep(doses_available, length(VE1) * 2)
deaths_averted_4_mill_doses_plot <- ggplot(data = df_deaths_averted_4_mill_doses, aes(x = Doses, y = `Deaths averted`, colour = VE_f, linetype = Strategy)) +
  geom_line(linewidth = 1) +
  scale_color_manual(values = c(cols, cols)) +
  labs(colour = "Vaccine effectiveness", x = "Doses available (millions)", title = "(a) 4 million doses") +
  theme_light(base_size = 18)

# 60 million doses

# One-dose vaccine allocation strategy

doses_available <- seq(0, 60, 5) 
prop_vaccinated_1_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
prop_vaccinated_1 <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
doses_allocated <- 0
VE1 <- seq(0.7, 0.85, 0.05) 
deaths_averted_60_mill_doses <- matrix(NA, nrow = length(doses_available), ncol = length(VE1) * 2)
allocation_matrix_condensed <- matrix(0, nrow = 26, ncol = 10)
allocation_matrix <- matrix(0, nrow = 26, ncol = 12)

for(k in 1:length(VE1)){
  for(j in 1:length(doses_available)){ 
    prop_vaccinated_1_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
    doses_allocated <- 0
    for (i in 1:length(prop_vaccinated_1_condensed)){
      if (doses_available[j] > (doses_allocated + uptake_1_condensed[i] * population_size_condensed[i])){
        prop_vaccinated_1_condensed[i] <- uptake_1_condensed[i]
        doses_allocated <- doses_allocated + uptake_1_condensed[i] * population_size_condensed[i]
      }
      else if ((doses_available[j] < (doses_allocated + uptake_1_condensed[i] * population_size_condensed[i])) && (doses_available[j] > doses_allocated)){
        prop_vaccinated_1_condensed[i] <- (doses_available[j] - doses_allocated) / population_size_condensed[i]
        doses_allocated <- doses_allocated + prop_vaccinated_1_condensed[i] * population_size_condensed[i]
      }
      else {
        prop_vaccinated_1_condensed[i] <- 0
      }
    }
    prop_vaccinated_1[1] <- min(prop_vaccinated_1_condensed[1], uptake_1[1])
    prop_vaccinated_1[2] <- min(prop_vaccinated_1_condensed[1], uptake_1[2])
    prop_vaccinated_1[3] <- min(prop_vaccinated_1_condensed[2], uptake_1[3])
    prop_vaccinated_1[4] <- min(prop_vaccinated_1_condensed[2], uptake_1[4])
    if (prop_vaccinated_1[4] == uptake_1_condensed[2]) {prop_vaccinated_1[4] <- uptake_1[4]}
    prop_vaccinated_1[5:12] <- prop_vaccinated_1_condensed[3:10]
    deaths_averted_60_mill_doses[j, k] = sum(prop_vaccinated_1 * VE1[k] * population_size * mortality_risk * 10^6)
    allocation_matrix_condensed[j,] <- prop_vaccinated_1_condensed
    allocation_matrix[j,] <- prop_vaccinated_1
  }
}

# Two-dose vaccine allocation strategy

doses_available <- seq(0, 60, 5) 
prop_vaccinated_2_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
prop_vaccinated_2 <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
doses_allocated <- 0
VE2 <- seq(0.75, 0.99, 0.08)

for(k in 1:length(VE2)){
  for(j in 1:length(doses_available)){
    prop_vaccinated_2_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
    doses_allocated <- 0
    for (i in 1:length(prop_vaccinated_2_condensed)){
      if ((doses_available[j] / 2) > (doses_allocated + uptake_2_condensed[i] * population_size_condensed[i])){
        prop_vaccinated_2_condensed[i] <- uptake_2_condensed[i]
        doses_allocated <- doses_allocated + uptake_2_condensed[i] * population_size_condensed[i]
      }
      else if (((doses_available[j] / 2) < (doses_allocated + uptake_2_condensed[i] * population_size_condensed[i])) && 
               ((doses_available[j] / 2) > doses_allocated)){
        prop_vaccinated_2_condensed[i] <- ((doses_available[j] / 2) - doses_allocated) / population_size_condensed[i]
        doses_allocated <- doses_allocated + prop_vaccinated_2_condensed[i] * population_size_condensed[i]
      }
      else {
        prop_vaccinated_2_condensed[i] <- 0
      }
    }
    prop_vaccinated_2[1] <- min(prop_vaccinated_2_condensed[1], uptake_2[1])
    prop_vaccinated_2[2] <- min(prop_vaccinated_2_condensed[1], uptake_2[2])
    prop_vaccinated_2[3] <- min(prop_vaccinated_2_condensed[2], uptake_2[3])
    prop_vaccinated_2[4] <- min(prop_vaccinated_2_condensed[2], uptake_2[4])
    prop_vaccinated_2[5:12] <- prop_vaccinated_2_condensed[3:10]
    deaths_averted_60_mill_doses[j, k + length(VE1)] = sum(prop_vaccinated_2 * VE2[k] * population_size * mortality_risk * 10^6)
    allocation_matrix_condensed[j + length(doses_available), ] <- prop_vaccinated_2_condensed
    allocation_matrix[j + length(doses_available), ] <- prop_vaccinated_2
  }
}


# Plotting deaths averted with 60 million doses

rownames(deaths_averted_60_mill_doses) <- doses_available
colnames(deaths_averted_60_mill_doses) <- c("1-dose, VE1 = 0.7", "1-dose, VE1 = 0.75", "1-dose, VE1 = 0.80", "1-dose, VE1 = 0.85",
                                            "2-dose, VE2 = 0.75", "2-dose, VE2 = 0.83", "2-dose, VE2 = 0.91", "2-dose, VE2 = 0.99")
df_deaths_averted_60_mill_doses <- data.frame(deaths_averted_60_mill_doses) |>
  pivot_longer(everything(),
               names_to = "Strategy and VE",
               values_to = "Deaths averted")
df_deaths_averted_60_mill_doses$Strategy <- c(rep("1-dose", length(doses_available) * length(VE1)), rep("2-dose", length(doses_available) * length(VE2)))
df_deaths_averted_60_mill_doses$VE <- c(rep("VE1 = 0.7", length(doses_available)), rep("VE1 = 0.75", length(doses_available)),
                                        rep("VE1 = 0.8", length(doses_available)), rep("VE1 = 0.85", length(doses_available)),
                                        rep("VE2 = 0.75", length(doses_available)), rep("VE2 = 0.83", length(doses_available)),
                                        rep("VE2 = 0.91", length(doses_available)), rep("VE2 = 0.99", length(doses_available)))
df_deaths_averted_60_mill_doses$VE_f <- factor(df_deaths_averted_60_mill_doses$VE, levels = 
                                                 c("VE1 = 0.7", "VE1 = 0.75", "VE1 = 0.8", "VE1 = 0.85", 
                                                   "VE2 = 0.75", "VE2 = 0.83", "VE2 = 0.91", "VE2 = 0.99"))
df_deaths_averted_60_mill_doses$Doses <- rep(doses_available, length(VE1) * 2)
deaths_averted_60_mill_doses_plot <- ggplot(data = df_deaths_averted_60_mill_doses, aes(x = Doses, y = `Deaths averted`, colour = VE_f, linetype = Strategy)) +
  geom_line(linewidth = 1) +
  scale_color_manual(values = c(cols, cols)) +
  labs(colour = "Vaccine effectiveness", x = "Doses available (millions)", title = "(b) 60 million doses") +
  theme_light(base_size = 18)

deaths_averted_panel_plot <- deaths_averted_4_mill_doses_plot + theme(legend.position = c(0.7, 0.2), legend.box = "horizontal") +
  guides(colour = guide_legend(ncol = 2)) +
  deaths_averted_60_mill_doses_plot + theme(legend.position = "None") +
  plot_layout(nrow = 2, axis_titles = "collect")

ggsave(filename = "Figure 2.pdf", plot = deaths_averted_panel_plot, width = 11, height = 13)

```

![Figure 2. Number of deaths averted following the one-dose-only and two-dose-only vaccination strategies. Up to four million doses are available in panel (a); panel (b) shows up to 60 million doses. The solid lines correspond to the one-dose strategy, and the dotted lines correspond to the two-dose strategy, with a range of vaccine effectiveness values considered for each strategy. VE1 represents the vaccine effectiveness of the first dose and VE2 represents the vaccine effectiveness of the second dose.](Figure 2.pdf)

*Figure 1* below shows the proportions of each priority group that are vaccinated following the one-dose only and two-dose only allocation strategies, with a total number of available doses ranging from five to 60 million.

```{r, echo = FALSE}

priority_group <- c("1a", "1b", "2a", "2b", "3", "4", "5", "6", "7", "8", "9", "10", 
                    "1a", "1b", "2a", "2b", "3", "4", "5", "6", "7", "8", "9", "10")
dose_strategy <- c(rep("1-dose", 12), rep("2-dose", 12))
plots <- list()

titles = array(c("0 doses", 
                 paste0("(a) 5 million doses<br>     ", round(100 * 5 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 5 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(b) 10 million doses<br>     ", round(100 * 10 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 10 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(c) 15 million doses<br>     ", round(100 * 15 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 15 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(d) 20 million doses<br>     ", round(100 * 20 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 20 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(e) 25 million doses<br>     ", round(100 * 25 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 25 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(f) 30 million doses<br>     ", round(100 * 30 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 30 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(g) 35 million doses<br>     ", round(100 * 35 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 35 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(h) 40 million doses<br>     ", round(100 * 40 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 40 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(i) 45 million doses<br>     ", round(100 * 45 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 45 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(j) 50 million doses<br>     ", round(100 * 50 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 50 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(k) 55 million doses<br>     ", round(100 * 55 / total_pop), "% 1-dose coverage<br>     ", 
                        round(100 * 55 / (2 * total_pop)), "% 2-dose coverage"), 
                 paste0("(l) 60 million doses<br>     ", 100, "% 1-dose coverage<br>     ", 
                        round(100 * 60 / (2 * total_pop)), "% 2-dose coverage")))

for (i in 1:length(doses_available)){
  data <- data.frame(
    priority_group = priority_group,  
    proportion_vaccinated = c(allocation_matrix[i, ], allocation_matrix[i + length(doses_available), ])
  )
  
  plots[[i]] <- ggplot(data, aes(x = priority_group, y = proportion_vaccinated, fill = dose_strategy)) + 
    ggtitle(titles[[i]]) + 
    geom_col(position = "dodge") + 
    scale_x_discrete (limits = c("1a", "1b", "2a", "2b", "3", "4", "5", "6", "7", "8", "9", "10"), 
                      name = "Priority group")  + 
    scale_y_continuous (name = "Proportion vaccinated", limits = c(0, 1.0), breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1.0))  + 
    scale_fill_manual(values = c("cadetblue", "coral") )  +
    labs(fill = "Dosing strategy") +
    theme_light(base_size = 13) + 
    theme(plot.title = element_textbox_simple(size = 13, fill = "white",
                                              colour = "black", box.colour = "black", linewidth = 1.5, width = NULL, padding = margin(5, 5, 5, 5),
                                              margin = margin(6, 6, 6, 6)),
          axis.text.x = element_text(size = 13, hjust = 1, vjust = 1, angle = 90),
          axis.text.y = element_text(size = 13), 
          axis.title = element_text(size = 13),
          plot.tag = element_text(size = 8),
          plot.tag.position = "bottom",
          plot.margin = unit(c(0, 0.2, 0, 0.2), "cm"))
  legend <- get_legend(plots[[i]])
  plots[[i]] <- plots[[i]] + theme(legend.position = "none")
}

figure_1 <-
  plots[[2]] + plots[[3]] + plots[[4]] +
  plots[[5]] + theme(legend.position = "right" ) +
  plots[[6]] + plots[[7]] + plots[[8]] + plots[[9]] + plots[[10]] + 
  plots[[11]] + plots[[12]] + plots[[13]] + plot_layout(nrow = 3, axes = "collect")

ggsave(filename = "Figure 1.pdf", plot = figure_1, width = 10, height = 8)

```

![Figure 1. Proportions of each priority group that are vaccinated following the one-dose only and two-dose only allocation strategies, with a total number of available doses ranging from five million (panel (a)) to 60 million (panel (l)) in increments of five million. The order in which the groups are vaccinated is held fixed according to the order in Table 1. The blue bars correspond to the one-dose strategy, and the red bars correspond to the two-dose strategy, and the percentage coverage of the total population under each strategy is shown in the panel titles. The priority groups are as follows: 1(a). Care home residents, 1(b). Residential care home workers, 2(a). ≥ 80 years, 2(b). Health and Social Care Workers, 3. 75–79 years, 4. 70–74 years & Clinically Extremely Vulnerable, 5. 65–69 years, 6. Underlying Health Conditions, 7. 60–64 years, 8. 55–59 years, 9. 50–54 years, 10. 0–49 years.](Figure 1.pdf)

#### **Estimating life-years saved as an alternative measure of disease impact**

The expected life-years remaining for the age groups were calculated by taking the mean expected number of years remaining across the ages in the age range, using the ONS National Life Tables dataset consisting of period life expectancies for the UK population, based on data from the years 2018 - 2020. (9) The life-years remaining for care home residents were assumed to be the same as for the over 80s, and for clinically extremely vulnerable individuals they were assumed to match the 70-74 age group. Those with underlying health conditions were assumed to have the same number of life-years remaining as the average for the 60-64 and 65-69 age groups. The life-years remaining for care home workers and HCW were estimated using the average age of care workers (42), and of NHS Hospital and Community Health Services staff (43) in England. (10, 11)

The expected number of years of life remaining for each priority group are below:

```{r}  

life_years_remaining <- c(4.74, 40.16, 4.74, 39.22, 10.86, 14.34, 18.16, 20.19, 22.22, 26.49, 30.93, 57.16) 

```

Life-years saved are plotted against the total number of available doses, following the one-dose only and two-dose only allocation strategies (figure 3).

```{r, echo = FALSE}


prop_vaccinated_1_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
prop_vaccinated_1 <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
doses_allocated <- 0
VE1 <- seq(0.7, 0.85, 0.05)         
doses_available <- seq(0, 4, 1) 
life_years_saved_4_mill_doses <- matrix(NA, nrow = length(doses_available), ncol = length(VE1) * 2)
allocation_matrix_condensed <- matrix(0, nrow = 26, ncol = 10)
allocation_matrix <- matrix(0, nrow = 26, ncol = 12)

for(k in 1:length(VE1)){
  for(j in 1:length(doses_available)){
    prop_vaccinated_1_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
    doses_allocated <- 0
    for (i in 1:length(prop_vaccinated_1_condensed)){
      if (doses_available[j] > (doses_allocated + uptake_1_condensed[i] * population_size_condensed[i])){
        prop_vaccinated_1_condensed[i] <- uptake_1_condensed[i]
        doses_allocated <- doses_allocated + uptake_1_condensed[i] * population_size_condensed[i]
      }
      else if ((doses_available[j] < (doses_allocated + uptake_1_condensed[i] * population_size_condensed[i])) && 
               (doses_available[j] > doses_allocated)){
        prop_vaccinated_1_condensed[i] <- (doses_available[j] - doses_allocated) / population_size_condensed[i]
        doses_allocated <- doses_allocated + prop_vaccinated_1_condensed[i] * population_size_condensed[i]
      }
      else {
        prop_vaccinated_1_condensed[i] <- 0
      }
    }
    prop_vaccinated_1[1] <- min(prop_vaccinated_1_condensed[1], uptake_1[1])
    prop_vaccinated_1[2] <- min(prop_vaccinated_1_condensed[1], uptake_1[2])
    prop_vaccinated_1[3] <- min(prop_vaccinated_1_condensed[2], uptake_1[3])
    prop_vaccinated_1[4] <- min(prop_vaccinated_1_condensed[2], uptake_1[4])
    if (prop_vaccinated_1[4] == uptake_1_condensed[2]) {prop_vaccinated_1[4] <- uptake_1[4]}
    prop_vaccinated_1[5:12] <- prop_vaccinated_1_condensed[3:10]
    life_years_saved_4_mill_doses[j, k] = sum(prop_vaccinated_1 * VE1[k] * population_size * mortality_risk * 
                                                life_years_remaining * 10^6)                 # Equation 3
    allocation_matrix_condensed[j,] <- prop_vaccinated_1_condensed
    allocation_matrix[j,] <- prop_vaccinated_1
  }
}


# Two-dose vaccine allocation strategy

# Equation 4 calculates the annual number of deaths averted following the two-dose allocation strategy

prop_vaccinated_2_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
prop_vaccinated_2 <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
doses_allocated <- 0
VE2 <- seq(0.75, 0.99, 0.08)          

for(k in 1:length(VE2)){
  for(j in 1:length(doses_available)){
    prop_vaccinated_2_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
    doses_allocated <- 0
    for (i in 1:length(prop_vaccinated_2_condensed)){
      if ((doses_available[j] / 2) > (doses_allocated + uptake_2_condensed[i] * population_size_condensed[i])){
        prop_vaccinated_2_condensed[i] <- uptake_2_condensed[i]
        doses_allocated <- doses_allocated + uptake_2_condensed[i] * population_size_condensed[i]
      }
      else if (((doses_available[j] / 2) < (doses_allocated + uptake_2_condensed[i] * population_size_condensed[i])) && 
               ((doses_available[j] / 2) > doses_allocated)){
        prop_vaccinated_2_condensed[i] <- ((doses_available[j] / 2) - doses_allocated) / population_size_condensed[i]
        doses_allocated <- doses_allocated + prop_vaccinated_2_condensed[i] * population_size_condensed[i]
      }
      else {
        prop_vaccinated_2_condensed[i] <- 0
      }
    }
    prop_vaccinated_2[1] <- min(prop_vaccinated_2_condensed[1], uptake_2[1])
    prop_vaccinated_2[2] <- min(prop_vaccinated_2_condensed[1], uptake_2[2])
    prop_vaccinated_2[3] <- min(prop_vaccinated_2_condensed[2], uptake_2[3])
    prop_vaccinated_2[4] <- min(prop_vaccinated_2_condensed[2], uptake_2[4])
    prop_vaccinated_2[5:12] <- prop_vaccinated_2_condensed[3:10]
    life_years_saved_4_mill_doses[j, k + length(VE1)] = sum(prop_vaccinated_2 * VE2[k] * population_size * mortality_risk * 
                                                              life_years_remaining * 10^6)                 # Equation 4
    allocation_matrix_condensed[j + length(doses_available), ] <- prop_vaccinated_2_condensed
    allocation_matrix[j + length(doses_available), ] <- prop_vaccinated_2
  }
}


# Plotting life-years saved with 4 million doses

rownames(life_years_saved_4_mill_doses) <- doses_available
colnames(life_years_saved_4_mill_doses) <- c("1-dose, VE1 = 0.7", "1-dose, VE1 = 0.75", "1-dose, VE1 = 0.80", "1-dose, VE1 = 0.85",
                                             "2-dose, VE2 = 0.75", "2-dose, VE2 = 0.83", "2-dose, VE2 = 0.91", "2-dose, VE2 = 0.99")
df_life_years_saved_4_mill_doses <- data.frame(life_years_saved_4_mill_doses) |>
  pivot_longer(everything(),
               names_to = "Strategy and VE",
               values_to = "Life-years saved")
df_life_years_saved_4_mill_doses$Strategy <- c(rep("1-dose", length(doses_available) * length(VE1)), 
                                               rep("2-dose", length(doses_available) * length(VE2)))
df_life_years_saved_4_mill_doses$VE <- c(rep("VE1 = 0.7", length(doses_available)), rep("VE1 = 0.75", length(doses_available)),
                                         rep("VE1 = 0.8", length(doses_available)), rep("VE1 = 0.85", length(doses_available)),
                                         rep("VE2 = 0.75", length(doses_available)), rep("VE2 = 0.83", length(doses_available)),
                                         rep("VE2 = 0.91", length(doses_available)), rep("VE2 = 0.99", length(doses_available)))
df_life_years_saved_4_mill_doses$VE_f <- factor(df_life_years_saved_4_mill_doses$VE, levels = 
                                                  c("VE1 = 0.7", "VE1 = 0.75", "VE1 = 0.8", "VE1 = 0.85", 
                                                    "VE2 = 0.75", "VE2 = 0.83", "VE2 = 0.91", "VE2 = 0.99"))
df_life_years_saved_4_mill_doses$Doses <- rep(doses_available, length(VE1) * 2)

life_years_saved_4_mill_doses_plot <- ggplot(data = df_life_years_saved_4_mill_doses, aes(x = Doses, y = `Life-years saved`, 
                                                                                          colour = VE_f, linetype = Strategy)) +
  geom_line(linewidth = 1) +
  scale_color_manual(values = c(cols, cols)) +
  labs(colour = "Vaccine effectiveness", x = "Doses available (millions)", title = "(a) 4 million doses") +
  theme_light(base_size = 18)

# One-dose vaccine allocation strategy

prop_vaccinated_1_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
prop_vaccinated_1 <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
doses_allocated <- 0
VE1 <- seq(0.7, 0.85, 0.05)         
doses_available <- seq(0, 60, 5) 
life_years_saved_60_mill_doses <- matrix(NA, nrow = length(doses_available), ncol = length(VE1) * 2)
allocation_matrix_condensed <- matrix(0, nrow = 26, ncol = 10)
allocation_matrix <- matrix(0, nrow = 26, ncol = 12)

for(k in 1:length(VE1)){
  for(j in 1:length(doses_available)){
    prop_vaccinated_1_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
    doses_allocated <- 0
    for (i in 1:length(prop_vaccinated_1_condensed)){
      if (doses_available[j] > (doses_allocated + uptake_1_condensed[i] * population_size_condensed[i])){
        prop_vaccinated_1_condensed[i] <- uptake_1_condensed[i]
        doses_allocated <- doses_allocated + uptake_1_condensed[i] * population_size_condensed[i]
      }
      else if ((doses_available[j] < (doses_allocated + uptake_1_condensed[i] * population_size_condensed[i])) && (doses_available[j] > doses_allocated)){
        prop_vaccinated_1_condensed[i] <- (doses_available[j] - doses_allocated) / population_size_condensed[i]
        doses_allocated <- doses_allocated + prop_vaccinated_1_condensed[i] * population_size_condensed[i]
      }
      else {
        prop_vaccinated_1_condensed[i] <- 0
      }
    }
    prop_vaccinated_1[1] <- min(prop_vaccinated_1_condensed[1], uptake_1[1])
    prop_vaccinated_1[2] <- min(prop_vaccinated_1_condensed[1], uptake_1[2])
    prop_vaccinated_1[3] <- min(prop_vaccinated_1_condensed[2], uptake_1[3])
    prop_vaccinated_1[4] <- min(prop_vaccinated_1_condensed[2], uptake_1[4])
    if (prop_vaccinated_1[4] == uptake_1_condensed[2]) {prop_vaccinated_1[4] <- uptake_1[4]}
    prop_vaccinated_1[5:12] <- prop_vaccinated_1_condensed[3:10]
    life_years_saved_60_mill_doses[j, k] = sum(prop_vaccinated_1 * VE1[k] * population_size * mortality_risk * 
                                                 life_years_remaining * 10^6)           #Equation 3
    allocation_matrix_condensed[j,] <- prop_vaccinated_1_condensed
    allocation_matrix[j,] <- prop_vaccinated_1
  }
}


# Two-dose vaccine allocation strategy

prop_vaccinated_2_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
prop_vaccinated_2 <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
doses_allocated <- 0
VE2 <- seq(0.75, 0.99, 0.08)          

for(k in 1:length(VE2)){
  for(j in 1:length(doses_available)){
    prop_vaccinated_2_condensed <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
    doses_allocated <- 0
    for (i in 1:length(prop_vaccinated_2_condensed)){
      if ((doses_available[j] / 2)>(doses_allocated + uptake_2_condensed[i] * population_size_condensed[i])){
        prop_vaccinated_2_condensed[i] <- uptake_2_condensed[i]
        doses_allocated <- doses_allocated + uptake_2_condensed[i] * population_size_condensed[i]
      }
      else if (((doses_available[j] / 2) < (doses_allocated + uptake_2_condensed[i] * population_size_condensed[i])) && 
               ((doses_available[j] / 2) > doses_allocated)){
        prop_vaccinated_2_condensed[i] <- ((doses_available[j] / 2) - doses_allocated) / population_size_condensed[i]
        doses_allocated <- doses_allocated + prop_vaccinated_2_condensed[i] * population_size_condensed[i]
      }
      else {
        prop_vaccinated_2_condensed[i] <- 0
      }
    }
    prop_vaccinated_2[1] <- min(prop_vaccinated_2_condensed[1], uptake_2[1])
    prop_vaccinated_2[2] <- min(prop_vaccinated_2_condensed[1], uptake_2[2])
    prop_vaccinated_2[3] <- min(prop_vaccinated_2_condensed[2], uptake_2[3])
    prop_vaccinated_2[4] <- min(prop_vaccinated_2_condensed[2], uptake_2[4])
    prop_vaccinated_2[5:12] <- prop_vaccinated_2_condensed[3:10]
    life_years_saved_60_mill_doses[j, k + length(VE1)] = sum(prop_vaccinated_2 * VE2[k] * population_size * mortality_risk * 
                                                               life_years_remaining * 10^6)             #Equation 4
    allocation_matrix_condensed[j + length(doses_available), ] <- prop_vaccinated_2_condensed
    allocation_matrix[j + length(doses_available), ] <- prop_vaccinated_2
  }
}


# Plotting life-years saved with 60 million doses

rownames(life_years_saved_60_mill_doses) <- doses_available
colnames(life_years_saved_60_mill_doses) <- c("1-dose, VE1 = 0.7", "1-dose, VE1 = 0.75", "1-dose, VE1 = 0.80", "1-dose, VE1 = 0.85",
                                              "2-dose, VE2 = 0.75", "2-dose, VE2 = 0.83", "2-dose, VE2 = 0.91", "2-dose, VE2 = 0.99")
df_life_years_saved_60_mill_doses <- data.frame(life_years_saved_60_mill_doses) |>
  pivot_longer(everything(),
               names_to = "Strategy and VE",
               values_to = "Life-years saved")
df_life_years_saved_60_mill_doses$Strategy <- c(rep("1-dose", length(doses_available) * length(VE1)), rep("2-dose", length(doses_available) * length(VE2)))
df_life_years_saved_60_mill_doses$VE <- c(rep("VE1 = 0.7", length(doses_available)), rep("VE1 = 0.75", length(doses_available)),
                                          rep("VE1 = 0.8", length(doses_available)), rep("VE1 = 0.85", length(doses_available)),
                                          rep("VE2 = 0.75", length(doses_available)), rep("VE2 = 0.83", length(doses_available)),
                                          rep("VE2 = 0.91", length(doses_available)), rep("VE2 = 0.99", length(doses_available)))
df_life_years_saved_60_mill_doses$VE_f <- factor(df_life_years_saved_60_mill_doses$VE, levels = 
                                                   c("VE1 = 0.7", "VE1 = 0.75", "VE1 = 0.8", "VE1 = 0.85", 
                                                     "VE2 = 0.75", "VE2 = 0.83", "VE2 = 0.91", "VE2 = 0.99"))
df_life_years_saved_60_mill_doses$Doses <- rep(doses_available, length(VE1) * 2)
life_years_saved_60_mill_doses_plot <- ggplot(data = df_life_years_saved_60_mill_doses, aes(x = Doses, y = `Life-years saved`, 
                                                                                            colour = VE_f, linetype = Strategy)) +
  geom_line(linewidth = 1) +
  scale_color_manual(values = c(cols, cols)) +
  labs(colour = "Vaccine effectiveness", x = "Doses available (millions)", title = "(b) 60 million doses") +
  theme_light(base_size = 18)

life_years_saved_panel_plot <- life_years_saved_4_mill_doses_plot + theme(legend.position = c(0.7, 0.2), legend.box = "horizontal") +
  guides(colour = guide_legend(ncol = 2)) +
  life_years_saved_60_mill_doses_plot + theme(legend.position = "None") +
  plot_layout(nrow = 2, axis_titles = "collect")

ggsave(filename = "Figure 3.pdf", plot = life_years_saved_panel_plot, width = 11, height = 13)

```

![Figure 3. Number of life-years saved following the one-dose-only and two-dose-only COVID-19 vaccination strategies. Up to four million doses are available in panel (a); panel (b) shows up to 60 million doses. The solid lines correspond to the one-dose strategy, and the dotted lines correspond to the two-dose strategy, with a range of vaccine effectiveness values considered for each strategy. VE1 is the vaccine effectiveness of the first dose and VE2 is the vaccine effectiveness of the second dose.](Figure 3.pdf)

#### **Investigating the order of priority group vaccination**

The optimal order of vaccination for each priority group is investigated to see how the ranking changes when maximising life years saved compared to deaths averted. In Table 2, the priority groups are ranked by the number of deaths averted and life-years saved by vaccinating each group up to the maximum uptake rate, using a first-dose vaccine effectiveness of 70% and a second-dose vaccine effectiveness of 75%. 

```{r, echo = FALSE}  

# Quantifying the optimal vaccination order depending on the objective

max_life_years_saved_by_group_one_dose <- (uptake_1 * VE1[1] * population_size * mortality_risk * life_years_remaining * 10^6)
max_life_years_saved_by_group_two_dose <- (uptake_2 * VE2[1] * population_size * mortality_risk * life_years_remaining * 10^6)

max_deaths_averted_by_group_one_dose <- (uptake_1 * VE1[1] * population_size * mortality_risk * 10^6)
max_deaths_averted_by_group_two_dose <- (uptake_2 * VE2[1] * population_size * mortality_risk * 10^6)

# Creating a table with the optimal orderings

deaths_averted_priority_groups_one_dose <- c(max_deaths_averted_by_group_one_dose[1] + max_deaths_averted_by_group_one_dose[2], 
                                             max_deaths_averted_by_group_one_dose[3] + max_deaths_averted_by_group_one_dose[4],
                                             max_deaths_averted_by_group_one_dose[5:12])
deaths_averted_priority_groups_two_dose <- c(max_deaths_averted_by_group_two_dose[1] + max_deaths_averted_by_group_two_dose[2], 
                                             max_deaths_averted_by_group_two_dose[3] + max_deaths_averted_by_group_two_dose[4],
                                             max_deaths_averted_by_group_two_dose[5:12])
life_years_saved_priority_groups_one_dose <- c(max_life_years_saved_by_group_one_dose[1] + max_life_years_saved_by_group_one_dose[2], 
                                               max_life_years_saved_by_group_one_dose[3] + max_life_years_saved_by_group_one_dose[4],
                                               max_life_years_saved_by_group_one_dose[5:12])
life_years_saved_priority_groups_two_dose <- c(max_life_years_saved_by_group_two_dose[1] + max_life_years_saved_by_group_two_dose[2], 
                                               max_life_years_saved_by_group_two_dose[3] + max_life_years_saved_by_group_two_dose[4],
                                               max_life_years_saved_by_group_two_dose[5:12])

priority_group_order <- data.frame(priority_groups = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"),
                                   strategy = c(rep("One-dose", 10), rep("Two-dose", 10)),
                                   deaths_averted = round(c(deaths_averted_priority_groups_one_dose,
                                                            deaths_averted_priority_groups_two_dose)),
                                   optimal_order_deaths = c(rank(-deaths_averted_priority_groups_one_dose), 
                                                            rank(-deaths_averted_priority_groups_two_dose)),
                                   life_years_saved = round(c(life_years_saved_priority_groups_one_dose, 
                                                              life_years_saved_priority_groups_two_dose)),
                                   optimal_order_life_years = c(rank(-life_years_saved_priority_groups_one_dose), 
                                                                rank(-life_years_saved_priority_groups_two_dose)))
colnames(priority_group_order) <- c("Priority group", "Dose strategy", "Deaths averted", "Ranking by deaths averted", "Life-years saved", 
                                    "Ranking by life-years saved")

# Table 2. Number of deaths averted and life-years saved in each priority group by vaccinating each group up to the maximum uptake rate, alongside the priority group vaccination order which maximises the number of deaths averted and life-years saved. The priority groups are ranked so that vaccinating the 1st ranked group averts the most deaths or life-years lost, and the 12th ranked group averts the fewest. Both the one-dose and two-dose vaccination strategies are shown here. A first-dose vaccine effectiveness of 70% and a second-dose vaccine effectiveness of 75% were used. 

# write.xlsx(priority_group_order, "Table 2. Priority group vaccination order.xlsx", rownames = TRUE)

knitr::kable(priority_group_order, format = "markdown", caption = "Table 2. Number of deaths averted and life-years saved in each priority group by vaccinating each group up to the maximum uptake rate, alongside the priority group vaccination order which maximises the number of deaths averted and life-years saved. The priority groups are ranked so that vaccinating the 1st ranked group averts the most deaths or life-years lost, and the 12th ranked group averts the fewest. Both the one-dose and two-dose vaccination strategies are shown here. A first-dose vaccine effectiveness of 70% and a second-dose vaccine effectiveness of 75% were used.")

```



### **Reference list**

1. Hill, E.M., Keeling, M.J., 2021. Comparison between one and two dose SARS-CoV-2 vaccine prioritization for a fixed number of vaccine doses. J R Soc Interface 18. https://doi.org/10.1098/rsif.2021.0214

2. Joint Committee on Vaccination and Immunisation, 2020a. Advice on priority groups for COVID-19 vaccination [WWW Document]. URL https://www.gov.uk/government/publications/priority-groups-for-coronavirus-covid-19-vaccination-advice-from-the-jcvi-30-december-2020/joint-committee-on-vaccination-and-immunisation-advice-on-priority-groups-for-covid-19-vaccination-30-december-2020 (accessed 11.25.24).

3. Department of Health and Social Care, 2021. UK COVID-19 vaccines delivery plan. https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/951928/uk-covid-19-vaccines-delivery-plan-final.pdf

4. Public Health England, 2021. COVID-19 vaccine surveillance report: 1 July 2021 (week 26). https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/998411/Vaccine_surveillance_report_-_week_26.pdf

5. NHS England, 2022a. Statistics » COVID-19 vaccinations archive – Weekly Publications » COVID-19 weekly announced vaccinations 03 March 2022 [WWW Document]. URL https://www.england.nhs.uk/statistics/statistical-work-areas/covid-19-vaccinations/covid-19-vaccinations-archive/covid-19-vaccinations-archive-weekly-publications/ (accessed 9.18.24).

6. Office for National Statistics, 2022a. Deaths registered weekly in England and Wales, provisional, 2020 edition [WWW Document]. URL https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/deaths/datasets/weeklyprovisionalfiguresondeathsregisteredinenglandandwales (accessed 3.17.22).

7. Office for National Statistics, 2022b. Number of deaths in care homes notified to the Care Quality Commission, England, 2020 edition [WWW Document]. URL https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/deaths/datasets/numberofdeathsincarehomesnotifiedtothecarequalitycommissionengland (accessed 3.17.22).

8. Office for National Statistics, 2021. Coronavirus (COVID-19) related deaths by occupation, England and Wales [WWW Document]. URL https://www.ons.gov.uk/peoplepopulationandcommunity/healthandsocialcare/causesofdeath/datasets/coronaviruscovid19relateddeathsbyoccupationenglandandwales (accessed 4.2.25).

9. Office for National Statistics, 2022c. National life tables: UK [WWW Document]. URL https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/lifeexpectancies/datasets/nationallifetablesunitedkingdomreferencetables (accessed 3.17.22).

10. NHS England, 2022b. HCHS staff by age breakdowns, September 2021. [ARCHIVED CONTENT] UK Government Web Archive - The National Archives [WWW Document]. URL https://webarchive.nationalarchives.gov.uk/ukgwa/20240503041912/https://digital.nhs.uk/supplementary-information/2022/hchs-staff-age-breakdown-sep21 (accessed 4.2.25).

11. Skills for Care’s Workforce Intelligence Team, 2024. The state of the adult social care sector and workforce in England [WWW Document]. URL https://www.skillsforcare.org.uk/Adult-Social-Care-Workforce-Data/Workforce-intelligence/publications/national-information/The-state-of-the-adult-social-care-sector-and-workforce-in-England.aspx (accessed 4.2.25).

